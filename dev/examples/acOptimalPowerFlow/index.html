<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>AC Optimal Power Flow · JuliaGrid</title><meta name="title" content="AC Optimal Power Flow · JuliaGrid"/><meta property="og:title" content="AC Optimal Power Flow · JuliaGrid"/><meta property="twitter:title" content="AC Optimal Power Flow · JuliaGrid"/><meta name="description" content="Documentation for JuliaGrid."/><meta property="og:description" content="Documentation for JuliaGrid."/><meta property="twitter:description" content="Documentation for JuliaGrid."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/tablestyle.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/subfigure.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="JuliaGrid logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuliaGrid</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../../manual/acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../../manual/dcPowerFlow/">DC Power Flow</a></li><li><a class="tocitem" href="../../manual/acOptimalPowerFlow/">AC Optimal Power Flow</a></li><li><a class="tocitem" href="../../manual/dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../../manual/measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../../manual/observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../../manual/acStateEstimation/">AC State Estimation</a></li><li><a class="tocitem" href="../../manual/pmuStateEstimation/">PMU State Estimation</a></li><li><a class="tocitem" href="../../manual/dcStateEstimation/">DC State Estimation</a></li><li><a class="tocitem" href="../../manual/badDataAnalysis/">Bad Data Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../../tutorials/acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../../tutorials/dcPowerFlow/">DC Power Flow</a></li><li><a class="tocitem" href="../../tutorials/acOptimalPowerFlow/">AC Optimal Power Flow</a></li><li><a class="tocitem" href="../../tutorials/dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../../tutorials/measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../../tutorials/observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../../tutorials/acStateEstimation/">AC State Estimation</a></li><li><a class="tocitem" href="../../tutorials/pmuStateEstimation/">PMU State Estimation</a></li><li><a class="tocitem" href="../../tutorials/dcStateEstimation/">DC State Estimation</a></li><li><a class="tocitem" href="../../tutorials/badDataAnalysis/">Bad Data Analysis</a></li><li><a class="tocitem" href="../../tutorials/perunit/">Per-Unit System</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../powerSystemDatasets/">Power System Datasets</a></li><li><a class="tocitem" href="../acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../dcPowerFlow/">DC Power Flow</a></li><li class="is-active"><a class="tocitem" href>AC Optimal Power Flow</a><ul class="internal"><li><a class="tocitem" href="#Base-Case-Analysis"><span>Base Case Analysis</span></a></li><li><a class="tocitem" href="#Modifying-Demands"><span>Modifying Demands</span></a></li><li><a class="tocitem" href="#Modifying-Generator-Costs"><span>Modifying Generator Costs</span></a></li><li><a class="tocitem" href="#Adding-Branch-Flow-Constraints"><span>Adding Branch Flow Constraints</span></a></li><li><a class="tocitem" href="#Modifying-Network-Topology"><span>Modifying Network Topology</span></a></li></ul></li><li><a class="tocitem" href="../dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../acStateEstimation/">AC State Estimation</a></li><li><a class="tocitem" href="../pmuStateEstimation/">PMU State Estimation</a></li><li><a class="tocitem" href="../dcStateEstimation/">DC State Estimation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../../api/powerFlow/">Power Flow</a></li><li><a class="tocitem" href="../../api/optimalPowerFlow/">Optimal Power Flow</a></li><li><a class="tocitem" href="../../api/measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../../api/stateEstimation/">State Estimation</a></li><li><a class="tocitem" href="../../api/analysis/">Powers and Currents</a></li><li><a class="tocitem" href="../../api/setupPrint/">Setup and Print</a></li><li><a class="tocitem" href="../../api/publicTypes/">Public Types</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Background</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../background/installation/">Installation Guide</a></li><li><a class="tocitem" href="../../background/bibliography/">Bibliography</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>AC Optimal Power Flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>AC Optimal Power Flow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mcosovic/JuliaGrid.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mcosovic/JuliaGrid.jl/blob/master/docs/src/examples/acOptimalPowerFlow.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ACOptimalPowerFlowExamples"><a class="docs-heading-anchor" href="#ACOptimalPowerFlowExamples">AC Optimal Power Flow</a><a id="ACOptimalPowerFlowExamples-1"></a><a class="docs-heading-anchor-permalink" href="#ACOptimalPowerFlowExamples" title="Permalink"></a></h1><p>This example performs multiple AC optimal power flow analyses on the power system shown in Figure 1. These simulations capture quasi-steady-state conditions under varying constraints and topology changes.</p><div style="text-align: center;">
    <img src="../../assets/acOptimalPowerFlow/4bus.svg" width="400"/>
    <p>Figure 1: The 4-bus power system.</p>
</div>
&nbsp;<div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Users can download a Julia script containing the scenarios from this section using the following <a href="https://github.com/mcosovic/JuliaGrid.jl/raw/refs/heads/master/docs/src/examples/analyses/acOptimalPowerFlow.jl">link</a>.</p></div></div><p>We begin by defining the units for active and reactive powers, as well as voltage magnitudes and angles, which will be used throughout this example:</p><pre><code class="language-julia hljs">@power(MW, MVAr)
@voltage(pu, deg)</code></pre><p>Next, we define bus parameters for the AC optimal power flow analysis. This includes specifying the slack bus (<code>type = 3</code>), where the bus voltage angle is set to zero by default, along with the corresponding <code>active</code> and <code>reactive</code> power loads, and shunt capacitor banks with <code>conductance</code> and <code>susceptance</code> values. The voltage magnitude limits for each bus are set using <code>minMagnitude</code> and <code>maxMagnitude</code>. With these definitions, we can begin building the power system model:</p><pre><code class="language-julia hljs">system = powerSystem()

@bus(minMagnitude = 0.95, maxMagnitude = 1.05)
addBus!(system; label = &quot;Bus 1&quot;, type = 3)
addBus!(system; label = &quot;Bus 2&quot;, active = 20.2, reactive = 10.5)
addBus!(system; label = &quot;Bus 3&quot;, conductance = 0.1, susceptance = 8.2)
addBus!(system; label = &quot;Bus 4&quot;, active = 50.8, reactive = 23.1)</code></pre><p>We define the transmission line parameters by specifying <code>resistance</code>, <code>reactance</code>, and <code>susceptance</code> values. At this stage, we do not impose any branch flow constraints, but they will be introduced later in the example:</p><pre><code class="language-julia hljs">@branch(label = &quot;Branch ?&quot;, reactance = 0.22)
addBranch!(system; from = &quot;Bus 1&quot;, to = &quot;Bus 3&quot;, resistance = 0.02, susceptance = 0.05)
addBranch!(system; from = &quot;Bus 1&quot;, to = &quot;Bus 2&quot;, resistance = 0.05, susceptance = 0.04)
addBranch!(system; from = &quot;Bus 2&quot;, to = &quot;Bus 3&quot;, resistance = 0.04, susceptance = 0.04)
addBranch!(system; from = &quot;Bus 3&quot;, to = &quot;Bus 4&quot;, turnsRatio = 0.98)</code></pre><p>We define the <code>active</code> and <code>reactive</code> power outputs of the generators, which serve as initial primal values for the optimization variables related to generator outputs. Reactive power outputs of the generators are limited by <code>minReactive</code> and <code>maxReactive</code>, while active power outputs vary between <code>minActive</code> and <code>maxActive</code>:</p><pre><code class="language-julia hljs">@generator(label = &quot;Generator ?&quot;, minActive = 2.0, minReactive = -15.5, maxReactive = 15.5)
addGenerator!(system; bus = &quot;Bus 1&quot;, active = 63.1, reactive = 8.2, maxActive = 65.5)
addGenerator!(system; bus = &quot;Bus 2&quot;, active = 3.0, reactive = 6.2, maxActive = 20.5)
addGenerator!(system; bus = &quot;Bus 2&quot;, active = 4.1, reactive = 8.5, maxActive = 22.4)</code></pre><p>Finally, we define the active power supply costs of the generators in polynomial form by setting <code>active = 2</code>. Then, we express the polynomial as a quadratic using the <code>polynomial</code> keyword:</p><pre><code class="language-julia hljs">cost!(system; generator = &quot;Generator 1&quot;, active = 2, polynomial = [0.04; 20.0; 0.0])
cost!(system; generator = &quot;Generator 2&quot;, active = 2, polynomial = [1.00; 20.0; 0.0])
cost!(system; generator = &quot;Generator 3&quot;, active = 2, polynomial = [1.00; 20.0; 0.0])</code></pre><p>After defining the power system data, we generate an AC model that includes essential vectors and matrices for analysis, such as the nodal admittance matrix:</p><pre><code class="language-julia hljs">acModel!(system)</code></pre><hr/><h5 id="Display-Data-Settings"><a class="docs-heading-anchor" href="#Display-Data-Settings">Display Data Settings</a><a id="Display-Data-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Display-Data-Settings" title="Permalink"></a></h5><p>Before running simulations, we configure the data display settings, including the selection of displayed data elements and the numeric format for relevant power values.</p><p>For bus-related data, we set:</p><pre><code class="language-julia hljs">show1 = Dict(&quot;Power Injection&quot; =&gt; false)
fmt1 = Dict(&quot;Power Generation&quot; =&gt; &quot;%.2f&quot;, &quot;Power Demand&quot; =&gt; &quot;%.2f&quot;, &quot;Shunt Power&quot; =&gt; &quot;%.2f&quot;)</code></pre><p>Similarly, for branch-related data, we choose:</p><pre><code class="language-julia hljs">show2 = Dict(&quot;Shunt Power&quot; =&gt; false, &quot;Status&quot; =&gt; false)
fmt2 = Dict(&quot;From-Bus Power&quot; =&gt; &quot;%.2f&quot;, &quot;To-Bus Power&quot; =&gt; &quot;%.2f&quot;, &quot;Series Power&quot; =&gt; &quot;%.2f&quot;)</code></pre><p>To display generator-related data, we also set:</p><pre><code class="language-julia hljs">show3 = Dict(&quot;Reactive Power Capability&quot; =&gt; false)
fmt3 = Dict(&quot;Power Output&quot; =&gt; &quot;%.2f&quot;)</code></pre><hr/><h2 id="Base-Case-Analysis"><a class="docs-heading-anchor" href="#Base-Case-Analysis">Base Case Analysis</a><a id="Base-Case-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Base-Case-Analysis" title="Permalink"></a></h2><p>First, we create the AC optimal power flow model and select the <code>Ipopt</code> solver. Next, we solve the model to determine bus voltage magnitudes and angles, along with the active and reactive power outputs of the generators. Afterward, we compute the remaining power values for buses and branches:</p><pre><code class="language-julia hljs">analysis = acOptimalPowerFlow(system, Ipopt.Optimizer)
powerFlow!(system, analysis, power = true, verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">
******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

EXIT: The optimal solution was found.</code></pre><p>Once the AC optimal power flow is solved, we can review the bus-related results, including the optimal values of bus voltage magnitudes and angles:</p><pre><code class="language-julia hljs">printBusData(system, analysis; show = show1, fmt = fmt1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Bus Data                                                                                 |
|------------------------------------------------------------------------------------------|
| Label |       Voltage        | Power Generation  |   Power Demand    |    Shunt Power    |
|       |                      |                   |                   |                   |
|   Bus | Magnitude |    Angle | Active | Reactive | Active | Reactive | Active | Reactive |
|       |      [pu] |    [deg] |   [MW] |   [MVAr] |   [MW] |   [MVAr] |   [MW] |   [MVAr] |
|-------|-----------|----------|--------|----------|--------|----------|--------|----------|
| Bus 1 |    1.0500 |   0.0000 |  65.50 |     7.96 |   0.00 |     0.00 |   0.00 |    -0.00 |
| Bus 2 |    1.0391 |  -3.0998 |   6.31 |    15.52 |  20.20 |    10.50 |   0.00 |    -0.00 |
| Bus 3 |    1.0182 |  -4.4294 |   0.00 |     0.00 |   0.00 |     0.00 |   0.10 |    -8.50 |
| Bus 4 |    0.9809 | -10.7249 |   0.00 |     0.00 |  50.80 |    23.10 |   0.00 |    -0.00 |
|------------------------------------------------------------------------------------------|</code></pre><p>The optimal active and reactive outputs of the generators are as follows:</p><pre><code class="language-julia hljs">printGeneratorData(system, analysis; fmt = fmt3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|--------------------------------------------------|
| Generator Data                                   |
|--------------------------------------------------|
|        Label        |   Power Output    | Status |
|                     |                   |        |
|   Generator |   Bus | Active | Reactive |        |
|             |       |   [MW] |   [MVAr] |        |
|-------------|-------|--------|----------|--------|
| Generator 1 | Bus 1 |  65.50 |     7.96 |      1 |
| Generator 2 | Bus 2 |   3.16 |     7.74 |      1 |
| Generator 3 | Bus 2 |   3.16 |     7.79 |      1 |
|--------------------------------------------------|</code></pre><p>As we can observe from the generator data, the <code>Generator 1</code>, which has the lowest costs, generates power at the maximum value. Additionally, we can observe that <code>Generator 2</code> and <code>Generator 3</code> have the same cost functions, which dictate that these two will produce an equal amount of active power.</p><p>We enabled users to display bus, branch, or generator data related to the optimal power analysis. For instance, for generator data, we can observe that the dual variables related to <code>Generator 1</code> are different from zero, indicating that the generator&#39;s output has reached its limit:</p><pre><code class="language-julia hljs">printGeneratorConstraint(system, analysis; show = show3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|--------------------------------------------------------|
| Generator Constraint Data                              |
|--------------------------------------------------------|
|    Label    |         Active Power Capability          |
|             |                                          |
|             | Minimum | Solution | Maximum |      Dual |
|             |    [MW] |     [MW] |    [MW] | [$/MW-hr] |
|-------------|---------|----------|---------|-----------|
| Generator 1 |  2.0000 |  65.5000 | 65.5000 |   -0.5987 |
| Generator 2 |  2.0000 |   3.1563 | 20.5000 |    0.0000 |
| Generator 3 |  2.0000 |   3.1563 | 22.4000 |    0.0000 |
|--------------------------------------------------------|</code></pre><p>Finally, we can also review the results related to branches:</p><pre><code class="language-julia hljs">printBranchData(system, analysis; show = show2, fmt = fmt2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Branch Data                                                                              |
|------------------------------------------------------------------------------------------|
|            Label             |  From-Bus Power   |   To-Bus Power    |   Series Power    |
|                              |                   |                   |                   |
|   Branch | From-Bus | To-Bus | Active | Reactive | Active | Reactive | Active | Reactive |
|          |          |        |   [MW] |   [MVAr] |   [MW] |   [MVAr] |   [MW] |   [MVAr] |
|----------|----------|--------|--------|----------|--------|----------|--------|----------|
| Branch 1 | Bus 1    | Bus 3  |  38.72 |    10.34 | -38.42 |   -12.36 |   0.30 |     3.33 |
| Branch 2 | Bus 1    | Bus 2  |  26.78 |    -2.39 | -26.45 |    -0.55 |   0.33 |     1.43 |
| Branch 3 | Bus 2    | Bus 3  |  12.57 |     5.57 | -12.48 |    -9.36 |   0.08 |     0.44 |
| Branch 4 | Bus 3    | Bus 4  |  50.80 |    30.22 | -50.80 |   -23.10 |   0.00 |     7.12 |
|------------------------------------------------------------------------------------------|</code></pre><p>Thus, we obtained the active and reactive power flows, as illustrated in Figure 2.</p><div class="image-container">
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_base_active.svg"/>
        <p>(a) Active powers.</p>
    </div>
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_base_reactive.svg"/>
        <p>(b) Reactive powers.</p>
    </div>
    <p style="text-align: center; margin-top: -5px;">
    Figure 2: Power flows in the 4-bus power system for the base case scenario.
    </p>
</div><hr/><h2 id="Modifying-Demands"><a class="docs-heading-anchor" href="#Modifying-Demands">Modifying Demands</a><a id="Modifying-Demands-1"></a><a class="docs-heading-anchor-permalink" href="#Modifying-Demands" title="Permalink"></a></h2><p>Let us now introduce a new state by updating the active and reactive power demands of consumers. These updates modify both the power system model and the AC optimal power flow model simultaneously:</p><pre><code class="language-julia hljs">updateBus!(system, analysis; label = &quot;Bus 2&quot;, active = 25.2, reactive = 13.5)
updateBus!(system, analysis; label = &quot;Bus 4&quot;, active = 43.3, reactive = 18.6)</code></pre><p>Next, we solve the AC optimal power flow again to compute the new solution without recreating the model. This step enables a warm start, as the initial primal and dual values correspond to those obtained in the base case:</p><pre><code class="language-julia hljs">powerFlow!(system, analysis, power = true, verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The optimal solution was found.</code></pre><p>Now, we observe the power output of the generators:</p><pre><code class="language-julia hljs">printGeneratorData(system, analysis; fmt = fmt3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|--------------------------------------------------|
| Generator Data                                   |
|--------------------------------------------------|
|        Label        |   Power Output    | Status |
|                     |                   |        |
|   Generator |   Bus | Active | Reactive |        |
|             |       |   [MW] |   [MVAr] |        |
|-------------|-------|--------|----------|--------|
| Generator 1 | Bus 1 |  63.65 |     3.37 |      1 |
| Generator 2 | Bus 2 |   2.79 |     7.66 |      1 |
| Generator 3 | Bus 2 |   2.79 |     7.66 |      1 |
|--------------------------------------------------|</code></pre><p>Compared to the base case, all generators have reduced power supplies due to lower demand. It is important to note that, although one might expect <code>Generator 1</code> to continue producing at maximum output because of its lower cost, while only <code>Generator 2</code> and <code>Generator 3</code> reduce their production, this is not the case. The reason is that the optimal power flow must also satisfy power balance and bus voltage magnitude constraints.</p><p>At the end of this scenario, we can review branch-related results for a more comprehensive insight into power flows:</p><pre><code class="language-julia hljs">printBranchData(system, analysis; show = show2, fmt = fmt2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Branch Data                                                                              |
|------------------------------------------------------------------------------------------|
|            Label             |  From-Bus Power   |   To-Bus Power    |   Series Power    |
|                              |                   |                   |                   |
|   Branch | From-Bus | To-Bus | Active | Reactive | Active | Reactive | Active | Reactive |
|          |          |        |   [MW] |   [MVAr] |   [MW] |   [MVAr] |   [MW] |   [MVAr] |
|----------|----------|--------|--------|----------|--------|----------|--------|----------|
| Branch 1 | Bus 1    | Bus 3  |  35.73 |     5.99 | -35.49 |    -8.69 |   0.25 |     2.70 |
| Branch 2 | Bus 1    | Bus 2  |  27.91 |    -2.62 | -27.56 |    -0.19 |   0.35 |     1.56 |
| Branch 3 | Bus 2    | Bus 3  |   7.95 |     2.00 |  -7.92 |    -6.11 |   0.03 |     0.16 |
| Branch 4 | Bus 3    | Bus 4  |  43.30 |    23.45 | -43.30 |   -18.60 |   0.00 |     4.85 |
|------------------------------------------------------------------------------------------|</code></pre><p>The obtained results allow us to illustrate the active and reactive power flows in Figure 3.</p><div class="image-container">
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_demand_active.svg"/>
        <p>(a) Active powers.</p>
    </div>
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_demand_reactive.svg"/>
        <p>(b) Reactive powers.</p>
    </div>
    <p style="text-align: center; margin-top: -5px;">
    Figure 3: Power flows in the 4-bus power system with modified demands.
    </p>
</div><hr/><h2 id="Modifying-Generator-Costs"><a class="docs-heading-anchor" href="#Modifying-Generator-Costs">Modifying Generator Costs</a><a id="Modifying-Generator-Costs-1"></a><a class="docs-heading-anchor-permalink" href="#Modifying-Generator-Costs" title="Permalink"></a></h2><p>We modify the cost functions for all generators, altering the objective function of the AC optimal power flow. By modifying the cost function of <code>Generator 1</code>, we shift it from being the lowest-cost to the highest-cost generator in the system. Updating both the power system model and the AC optimal power flow model simultaneously allows us to enable a warm start for the optimization problem:</p><pre><code class="language-julia hljs">cost!(system, analysis; generator = &quot;Generator 1&quot;, active = 2, polynomial = [2.0; 20.0; 0.0])
cost!(system, analysis; generator = &quot;Generator 2&quot;, active = 2, polynomial = [0.8; 20.0; 0.0])
cost!(system, analysis; generator = &quot;Generator 3&quot;, active = 2, polynomial = [0.8; 20.0; 0.0])</code></pre><p>Next, we solve the updated problem and calculate the resulting powers:</p><pre><code class="language-julia hljs">powerFlow!(system, analysis, power = true, verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The optimal solution was found.</code></pre><p>The optimal active and reactive power outputs of the generators are as follows:</p><pre><code class="language-julia hljs">printGeneratorData(system, analysis; fmt = fmt3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|--------------------------------------------------|
| Generator Data                                   |
|--------------------------------------------------|
|        Label        |   Power Output    | Status |
|                     |                   |        |
|   Generator |   Bus | Active | Reactive |        |
|             |       |   [MW] |   [MVAr] |        |
|-------------|-------|--------|----------|--------|
| Generator 1 | Bus 1 |  25.98 |     1.87 |      1 |
| Generator 2 | Bus 2 |  20.50 |     7.11 |      1 |
| Generator 3 | Bus 2 |  22.40 |     7.11 |      1 |
|--------------------------------------------------|</code></pre><p>In this scenario, we observe that, due to the increased cost of <code>Generator 1</code>, both <code>Generator 2</code> and <code>Generator 3</code> have increased their production to the maximum possible values to capitalize on their lower costs. The remaining required active power is then supplied by <code>Generator 1</code>.</p><p>We can also review the results related to branches for this scenario:</p><pre><code class="language-julia hljs">printBranchData(system, analysis; show = show2, fmt = fmt2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Branch Data                                                                              |
|------------------------------------------------------------------------------------------|
|            Label             |  From-Bus Power   |   To-Bus Power    |   Series Power    |
|                              |                   |                   |                   |
|   Branch | From-Bus | To-Bus | Active | Reactive | Active | Reactive | Active | Reactive |
|          |          |        |   [MW] |   [MVAr] |   [MW] |   [MVAr] |   [MW] |   [MVAr] |
|----------|----------|--------|--------|----------|--------|----------|--------|----------|
| Branch 1 | Bus 1    | Bus 3  |  23.14 |     4.30 | -23.03 |    -8.55 |   0.11 |     1.17 |
| Branch 2 | Bus 1    | Bus 2  |   2.84 |    -2.43 |  -2.83 |    -1.96 |   0.00 |     0.02 |
| Branch 3 | Bus 2    | Bus 3  |  20.53 |     2.69 | -20.37 |    -6.13 |   0.16 |     0.89 |
| Branch 4 | Bus 3    | Bus 4  |  43.30 |    23.41 | -43.30 |   -18.60 |   0.00 |     4.81 |
|------------------------------------------------------------------------------------------|</code></pre><p>Figure 4 illustrates the power flows for this scenario. Compared to the previous scenario, Figure 4a shows that <code>Branch 2</code> has significantly lower active power flow, while <code>Branch 3</code> has become considerably more loaded.</p><div class="image-container">
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_cost_active.svg"/>
        <p>(a) Active powers.</p>
    </div>
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_cost_reactive.svg"/>
        <p>(b) Reactive powers.</p>
    </div>
    <p style="text-align: center; margin-top: -5px;">
    Figure 4: Power flows in the 4-bus power system with modified generator costs.
    </p>
</div><hr/><h2 id="Adding-Branch-Flow-Constraints"><a class="docs-heading-anchor" href="#Adding-Branch-Flow-Constraints">Adding Branch Flow Constraints</a><a id="Adding-Branch-Flow-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-Branch-Flow-Constraints" title="Permalink"></a></h2><p>To limit active power flow, we introduce constraints on <code>Branch 2</code> and <code>Branch 3</code> by setting <code>type = 1</code>, where the active power flow at the from-bus end of these branches is limited using the <code>maxFromBus</code> keyword:</p><pre><code class="language-julia hljs">updateBranch!(system, analysis; label = &quot;Branch 2&quot;, type = 1, maxFromBus = 15.0)
updateBranch!(system, analysis; label = &quot;Branch 3&quot;, type = 1, maxFromBus = 15.0)</code></pre><p>Next, we recalculate the AC optimal power flow:</p><pre><code class="language-julia hljs">powerFlow!(system, analysis, power = true, verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The optimal solution was found.</code></pre><p>Now, let us observe the generator outputs:</p><pre><code class="language-julia hljs">printGeneratorData(system, analysis; fmt = fmt3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|--------------------------------------------------|
| Generator Data                                   |
|--------------------------------------------------|
|        Label        |   Power Output    | Status |
|                     |                   |        |
|   Generator |   Bus | Active | Reactive |        |
|             |       |   [MW] |   [MVAr] |        |
|-------------|-------|--------|----------|--------|
| Generator 1 | Bus 1 |  42.10 |   -13.52 |      1 |
| Generator 2 | Bus 2 |  13.46 |    15.50 |      1 |
| Generator 3 | Bus 2 |  13.46 |    15.50 |      1 |
|--------------------------------------------------|</code></pre><p>The power flow limit at <code>Branch 3</code> forces <code>Generator 1</code> to increase its active power output despite its higher cost compared to <code>Generator 2</code> and <code>Generator 3</code>, due to the need to satisfy all constraints. Additionally, we also observe a significant redistribution in the production of reactive powers.</p><p>We can review the branch data constraints and observe that the active power at the from-bus end of <code>Branch 3</code> reaches the defined limit, which leads to the power redistribution described earlier, while the power flow at <code>Branch 2</code> stays within the specified limits:</p><pre><code class="language-julia hljs">printBranchConstraint(system, analysis)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|-----------------------------------------------------|
| Branch Constraint Data                              |
|-----------------------------------------------------|
|  Label   |        From-Bus Active Power Flow        |
|          |                                          |
|          | Minimum | Solution | Maximum |      Dual |
|          |    [MW] |     [MW] |    [MW] | [$/MW-hr] |
|----------|---------|----------|---------|-----------|
| Branch 2 |  0.0000 |  13.4196 | 15.0000 |   -0.0000 |
| Branch 3 |  0.0000 |  15.0000 | 15.0000 | -439.7438 |
|-----------------------------------------------------|</code></pre><p>Finally, we can review the branch-related data to examine the redistribution of powers in detail:</p><pre><code class="language-julia hljs">printBranchData(system, analysis; show = show2, fmt = fmt2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Branch Data                                                                              |
|------------------------------------------------------------------------------------------|
|            Label             |  From-Bus Power   |   To-Bus Power    |   Series Power    |
|                              |                   |                   |                   |
|   Branch | From-Bus | To-Bus | Active | Reactive | Active | Reactive | Active | Reactive |
|          |          |        |   [MW] |   [MVAr] |   [MW] |   [MVAr] |   [MW] |   [MVAr] |
|----------|----------|--------|--------|----------|--------|----------|--------|----------|
| Branch 1 | Bus 1    | Bus 3  |  28.68 |    -0.26 | -28.52 |    -3.31 |   0.16 |     1.71 |
| Branch 2 | Bus 1    | Bus 2  |  13.42 |   -13.25 | -13.28 |     9.55 |   0.14 |     0.63 |
| Branch 3 | Bus 2    | Bus 3  |  15.00 |     7.95 | -14.88 |   -11.60 |   0.12 |     0.65 |
| Branch 4 | Bus 3    | Bus 4  |  43.30 |    23.50 | -43.30 |   -18.60 |   0.00 |     4.90 |
|------------------------------------------------------------------------------------------|</code></pre><p>Based on the obtained results, we can illustrate the power flows in Figure 5.</p><div class="image-container">
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_flow_active.svg"/>
        <p>(a) Active powers.</p>
    </div>
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_flow_reactive.svg"/>
        <p>(b) Reactive powers.</p>
    </div>
    <p style="text-align: center; margin-top: -5px;">
    Figure 5: Power flows in the 4-bus power system with added branch flow constraints.
    </p>
</div><hr/><h2 id="Modifying-Network-Topology"><a class="docs-heading-anchor" href="#Modifying-Network-Topology">Modifying Network Topology</a><a id="Modifying-Network-Topology-1"></a><a class="docs-heading-anchor-permalink" href="#Modifying-Network-Topology" title="Permalink"></a></h2><p>At the end, we set <code>Branch 2</code> out-of-service:</p><pre><code class="language-julia hljs">updateBranch!(system, analysis; label = &quot;Branch 2&quot;, status = 0)</code></pre><p>We then recalculate the AC optimal power flow:</p><pre><code class="language-julia hljs">powerFlow!(system, analysis, power = true, verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The optimal solution was found.</code></pre><p>We can now observe the updated generator outputs:</p><pre><code class="language-julia hljs">printGeneratorData(system, analysis; fmt = fmt3)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|--------------------------------------------------|
| Generator Data                                   |
|--------------------------------------------------|
|        Label        |   Power Output    | Status |
|                     |                   |        |
|   Generator |   Bus | Active | Reactive |        |
|             |       |   [MW] |   [MVAr] |        |
|-------------|-------|--------|----------|--------|
| Generator 1 | Bus 1 |  28.66 |     4.88 |      1 |
| Generator 2 | Bus 2 |  20.10 |     7.94 |      1 |
| Generator 3 | Bus 2 |  20.10 |     7.94 |      1 |
|--------------------------------------------------|</code></pre><p>Due to the outage of <code>Branch 2</code> and the flow limit at <code>Branch 3</code>, <code>Generator 1</code> faces difficulties supplying load at <code>Bus 2</code>, reducing its output. Consequently, the only solution is to increase the output of <code>Generator 2</code> and <code>Generator 3</code>.</p><p>Upon reviewing the branch data, we observe that the active power flows in the remaining in-service branches remain largely unchanged. This is because, following the outage of <code>Branch 2</code>, <code>Generator 2</code> and <code>Generator 3</code> have taken over the responsibility of supplying the load at <code>Bus 2</code>, effectively displacing <code>Generator 1</code>:</p><pre><code class="language-julia hljs">printBranchData(system, analysis; show = show2, fmt = fmt2)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Branch Data                                                                              |
|------------------------------------------------------------------------------------------|
|            Label             |  From-Bus Power   |   To-Bus Power    |   Series Power    |
|                              |                   |                   |                   |
|   Branch | From-Bus | To-Bus | Active | Reactive | Active | Reactive | Active | Reactive |
|          |          |        |   [MW] |   [MVAr] |   [MW] |   [MVAr] |   [MW] |   [MVAr] |
|----------|----------|--------|--------|----------|--------|----------|--------|----------|
| Branch 1 | Bus 1    | Bus 3  |  28.66 |     4.88 | -28.50 |    -8.54 |   0.16 |     1.76 |
| Branch 2 | Bus 1    | Bus 2  |   0.00 |     0.00 |   0.00 |     0.00 |   0.00 |     0.00 |
| Branch 3 | Bus 2    | Bus 3  |  15.00 |     2.37 | -14.91 |    -6.18 |   0.09 |     0.50 |
| Branch 4 | Bus 3    | Bus 4  |  43.30 |    23.42 | -43.30 |   -18.60 |   0.00 |     4.82 |
|------------------------------------------------------------------------------------------|</code></pre><p>Figure 6 illustrates these results under the outage of <code>Branch 2</code>.</p><div class="image-container">
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_service_active.svg"/>
        <p>(a) Active powers.</p>
    </div>
    <div class="image-item">
        <img src="../../assets/acOptimalPowerFlow/4bus_service_reactive.svg"/>
        <p>(b) Reactive powers.</p>
    </div>
    <p style="text-align: center; margin-top: -5px;">
    Figure 6: Power flows in the 4-bus power system with modified network topology.
    </p>
</div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dcPowerFlow/">« DC Power Flow</a><a class="docs-footer-nextpage" href="../dcOptimalPowerFlow/">DC Optimal Power Flow »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Saturday 15 March 2025 11:09">Saturday 15 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
