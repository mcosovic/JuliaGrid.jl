<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>PMU State Estimation · JuliaGrid</title><meta name="title" content="PMU State Estimation · JuliaGrid"/><meta property="og:title" content="PMU State Estimation · JuliaGrid"/><meta property="twitter:title" content="PMU State Estimation · JuliaGrid"/><meta name="description" content="Documentation for JuliaGrid."/><meta property="og:description" content="Documentation for JuliaGrid."/><meta property="twitter:description" content="Documentation for JuliaGrid."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/tablestyle.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/subfigure.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="JuliaGrid logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuliaGrid</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../../manual/acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../../manual/dcPowerFlow/">DC Power Flow</a></li><li><a class="tocitem" href="../../manual/acOptimalPowerFlow/">AC Optimal Power Flow</a></li><li><a class="tocitem" href="../../manual/dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../../manual/measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../../manual/observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../../manual/acStateEstimation/">AC State Estimation</a></li><li><a class="tocitem" href="../../manual/pmuStateEstimation/">PMU State Estimation</a></li><li><a class="tocitem" href="../../manual/dcStateEstimation/">DC State Estimation</a></li><li><a class="tocitem" href="../../manual/badDataAnalysis/">Bad Data Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../../tutorials/acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../../tutorials/dcPowerFlow/">DC Power Flow</a></li><li><a class="tocitem" href="../../tutorials/acOptimalPowerFlow/">AC Optimal Power Flow</a></li><li><a class="tocitem" href="../../tutorials/dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../../tutorials/measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../../tutorials/observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../../tutorials/acStateEstimation/">AC State Estimation</a></li><li><a class="tocitem" href="../../tutorials/pmuStateEstimation/">PMU State Estimation</a></li><li><a class="tocitem" href="../../tutorials/dcStateEstimation/">DC State Estimation</a></li><li><a class="tocitem" href="../../tutorials/badDataAnalysis/">Bad Data Analysis</a></li><li><a class="tocitem" href="../../tutorials/perunit/">Per-Unit System</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../powerSystemDatasets/">Power System Datasets</a></li><li><a class="tocitem" href="../acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../dcPowerFlow/">DC Power Flow</a></li><li><a class="tocitem" href="../acOptimalPowerFlow/">AC Optimal Power Flow</a></li><li><a class="tocitem" href="../dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../acStateEstimation/">AC State Estimation</a></li><li class="is-active"><a class="tocitem" href>PMU State Estimation</a><ul class="internal"><li><a class="tocitem" href="#Optimal-PMU-Placement"><span>Optimal PMU Placement</span></a></li><li><a class="tocitem" href="#Measurement-Model"><span>Measurement Model</span></a></li><li><a class="tocitem" href="#Base-Case-Analysis"><span>Base Case Analysis</span></a></li><li><a class="tocitem" href="#Modifying-Measurement-Data"><span>Modifying Measurement Data</span></a></li><li><a class="tocitem" href="#Modifying-Measurement-Set"><span>Modifying Measurement Set</span></a></li></ul></li><li><a class="tocitem" href="../dcStateEstimation/">DC State Estimation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../../api/powerFlow/">Power Flow</a></li><li><a class="tocitem" href="../../api/optimalPowerFlow/">Optimal Power Flow</a></li><li><a class="tocitem" href="../../api/measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../../api/stateEstimation/">State Estimation</a></li><li><a class="tocitem" href="../../api/analysis/">Powers and Currents</a></li><li><a class="tocitem" href="../../api/setupPrint/">Setup and Print</a></li><li><a class="tocitem" href="../../api/publicTypes/">Public Types</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Background</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../background/installation/">Installation Guide</a></li><li><a class="tocitem" href="../../background/bibliography/">Bibliography</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>PMU State Estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>PMU State Estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mcosovic/JuliaGrid.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mcosovic/JuliaGrid.jl/blob/master/docs/src/examples/pmuStateEstimation.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="PMUStateEstimationExamples"><a class="docs-heading-anchor" href="#PMUStateEstimationExamples">PMU State Estimation</a><a id="PMUStateEstimationExamples-1"></a><a class="docs-heading-anchor-permalink" href="#PMUStateEstimationExamples" title="Permalink"></a></h1><p>This example examines a 6-bus power system, illustrated in Figure 1. The goal is to estimate bus voltage magnitudes and angles using only phasor measurements.</p><div style="text-align: center;">
    <img src="../../assets/pmuStateEstimation/6bus.svg" width="360"/>
    <p>Figure 1: The 6-bus power system.</p>
</div>
&nbsp;<div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>Users can download a Julia script containing the scenarios from this section using the following <a href="https://github.com/mcosovic/JuliaGrid.jl/raw/refs/heads/master/docs/src/examples/analyses/pmuStateEstimation.jl">link</a>.</p></div></div><p>The power system is defined by specifying buses and branches, with the generator assigned to the slack bus:</p><pre><code class="language-julia hljs">system = powerSystem()

addBus!(system; label = &quot;Bus 1&quot;, type = 3)
addBus!(system; label = &quot;Bus 2&quot;)
addBus!(system; label = &quot;Bus 3&quot;)
addBus!(system; label = &quot;Bus 4&quot;)
addBus!(system; label = &quot;Bus 5&quot;)
addBus!(system; label = &quot;Bus 6&quot;)

@branch(resistance = 0.02)
addBranch!(system; label = &quot;Branch 1&quot;, from = &quot;Bus 1&quot;, to = &quot;Bus 2&quot;, reactance = 0.05)
addBranch!(system; label = &quot;Branch 2&quot;, from = &quot;Bus 2&quot;, to = &quot;Bus 3&quot;, reactance = 0.23)
addBranch!(system; label = &quot;Branch 3&quot;, from = &quot;Bus 3&quot;, to = &quot;Bus 4&quot;, reactance = 0.19)
addBranch!(system; label = &quot;Branch 4&quot;, from = &quot;Bus 4&quot;, to = &quot;Bus 5&quot;, reactance = 0.17)
addBranch!(system; label = &quot;Branch 5&quot;, from = &quot;Bus 5&quot;, to = &quot;Bus 6&quot;, reactance = 0.04)
addBranch!(system; label = &quot;Branch 6&quot;, from = &quot;Bus 1&quot;, to = &quot;Bus 6&quot;, reactance = 0.21)
addBranch!(system; label = &quot;Branch 7&quot;, from = &quot;Bus 2&quot;, to = &quot;Bus 6&quot;, reactance = 0.13)
addBranch!(system; label = &quot;Branch 8&quot;, from = &quot;Bus 5&quot;, to = &quot;Bus 2&quot;, reactance = 0.34)

addGenerator!(system; label = &quot;Generator 1&quot;, bus = &quot;Bus 1&quot;)</code></pre><hr/><h5 id="Display-Data-Settings"><a class="docs-heading-anchor" href="#Display-Data-Settings">Display Data Settings</a><a id="Display-Data-Settings-1"></a><a class="docs-heading-anchor-permalink" href="#Display-Data-Settings" title="Permalink"></a></h5><p>Before running simulations, we configure the data display settings:</p><pre><code class="language-julia hljs">show = Dict(&quot;Shunt Power&quot; =&gt; false, &quot;Status&quot; =&gt; false, &quot;Series Power&quot; =&gt; false)</code></pre><hr/><h2 id="Optimal-PMU-Placement"><a class="docs-heading-anchor" href="#Optimal-PMU-Placement">Optimal PMU Placement</a><a id="Optimal-PMU-Placement-1"></a><a class="docs-heading-anchor-permalink" href="#Optimal-PMU-Placement" title="Permalink"></a></h2><p>Next, PMUs need to be assigned to the power system shown in Figure 1. The placement is determined using an optimal PMU placement strategy that ensures observability with the minimal number of PMUs:</p><pre><code class="language-julia hljs">placement = pmuPlacement(system, HiGHS.Optimizer; verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The optimal solution was found.</code></pre><p>This provides the bus configuration where PMUs should be installed:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; placement.bus</code><code class="nohighlight hljs ansi" style="display:block;">OrderedCollections.OrderedDict{String, Int64} with 2 entries:
  &quot;Bus 2&quot; =&gt; 2
  &quot;Bus 5&quot; =&gt; 5</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>PMUs installed at these buses will measure bus voltage phasors and all currents in branches connected to those buses. Specifically, current phasors will be measured in the following branches:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; placement.from</code><code class="nohighlight hljs ansi" style="display:block;">OrderedCollections.OrderedDict{String, Int64} with 4 entries:
  &quot;Branch 2&quot; =&gt; 2
  &quot;Branch 7&quot; =&gt; 7
  &quot;Branch 5&quot; =&gt; 5
  &quot;Branch 8&quot; =&gt; 8</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; placement.to</code><code class="nohighlight hljs ansi" style="display:block;">OrderedCollections.OrderedDict{String, Int64} with 3 entries:
  &quot;Branch 1&quot; =&gt; 1
  &quot;Branch 8&quot; =&gt; 8
  &quot;Branch 4&quot; =&gt; 4</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><p>If users choose to generate phasor measurement values using optimal power flow or power flow analysis, the integers within bus and branch labels indicate positions in vectors where these values are stored.</p><p>Hence, Figure 2 illustrates the phasor measurement configuration, which includes bus voltage and branch current phasor measurements.</p><div style="text-align: center;">
    <img src="../../assets/pmuStateEstimation/6bus_phasor.svg" width="340"/>
    <p>Figure 2: The 6-bus power system with phasor measurement configuration.</p>
</div>
&nbsp;<p>Finally, phasor measurements need to be defined. The question is how to obtain measurement values. In this example, AC power flow results will be used to generate synthetic measurements.</p><hr/><h2 id="Measurement-Model"><a class="docs-heading-anchor" href="#Measurement-Model">Measurement Model</a><a id="Measurement-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Measurement-Model" title="Permalink"></a></h2><p>To begin, let us initialize the measurement variable:</p><pre><code class="language-julia hljs">device = measurement()</code></pre><hr/><h5 id="AC-Power-Flow"><a class="docs-heading-anchor" href="#AC-Power-Flow">AC Power Flow</a><a id="AC-Power-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#AC-Power-Flow" title="Permalink"></a></h5><p>AC power flow analysis requires generator and load data. The system configuration is shown in Figure 3.</p><div style="text-align: center;">
    <img src="../../assets/pmuStateEstimation/6bus_acpf.svg" width="450"/>
    <p>Figure 3: The 6-bus power system with generators and loads.</p>
</div>
&nbsp;<p>Data for loads and generators is added as follows:</p><pre><code class="language-julia hljs">updateBus!(system; label = &quot;Bus 2&quot;, type = 1, active = 0.217, reactive = 0.127)
updateBus!(system; label = &quot;Bus 3&quot;, type = 1, active = 0.478, reactive = -0.039)
updateBus!(system; label = &quot;Bus 4&quot;, type = 2, active = 0.076, reactive = 0.016)
updateBus!(system; label = &quot;Bus 5&quot;, type = 1, active = 0.112, reactive = 0.075)
updateBus!(system; label = &quot;Bus 6&quot;, type = 1, active = 0.295, reactive = 0.166)

updateGenerator!(system; label = &quot;Generator 1&quot;, active = 2.324, reactive = -0.169)
addGenerator!(system; label = &quot;Generator 2&quot;, bus = &quot;Bus 4&quot;, active = 0.412, reactive = 0.234)</code></pre><p>Next, AC power flow analysis is performed to obtain bus voltages:</p><pre><code class="language-julia hljs">acModel!(system)

powerFlow = newtonRaphson(system)
powerFlow!(system, powerFlow; verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The solution was found using the Newton-Raphson method in 3 iterations.</code></pre><hr/><h5 id="Bus-Voltage-Phasor-Measurements"><a class="docs-heading-anchor" href="#Bus-Voltage-Phasor-Measurements">Bus Voltage Phasor Measurements</a><a id="Bus-Voltage-Phasor-Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Bus-Voltage-Phasor-Measurements" title="Permalink"></a></h5><p>To obtain bus voltage phasor measurements, the exact values and optimal PMU placement data are used. By setting <code>noise = true</code>, white Gaussian noise with a default <code>variance</code> of <code>1e-8</code> is added to the magnitude and angle values:</p><pre><code class="language-julia hljs">@pmu(label = &quot;!&quot;)
for (bus, idx) in placement.bus
    Vᵢ, θᵢ = powerFlow.voltage.magnitude[idx], powerFlow.voltage.angle[idx]
    addPmu!(system, device; bus = bus, magnitude = Vᵢ, angle = θᵢ, noise = true)
end</code></pre><hr/><h5 id="Branch-Current-Phasor-Measurements"><a class="docs-heading-anchor" href="#Branch-Current-Phasor-Measurements">Branch Current Phasor Measurements</a><a id="Branch-Current-Phasor-Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Branch-Current-Phasor-Measurements" title="Permalink"></a></h5><p>To add branch current phasor measurements, the current magnitudes and angles are first computed. These values are then used to form measurements, where the exact values are used as the <code>noise</code> keyword is ignored:</p><pre><code class="language-julia hljs">for branch in keys(placement.from)
    Iᵢⱼ, ψᵢⱼ = fromCurrent(system, powerFlow; label = branch)
    addPmu!(system, device; from = branch, magnitude = Iᵢⱼ, angle = ψᵢⱼ)
end
for branch in keys(placement.to)
    Iⱼᵢ, ψⱼᵢ = toCurrent(system, powerFlow; label = branch)
    addPmu!(system, device; to = branch, magnitude = Iⱼᵢ, angle = ψⱼᵢ)
end</code></pre><p>Current phasor measurements can also be generated in the same way as voltage phasors by invoking the <a href="../../api/analysis/#JuliaGrid.current!-Tuple{PowerSystem, AC}"><code>current!</code></a> function after AC state estimation has converged.</p><p>Note that the formation of bus voltage and branch current measurements can be performed by calling the <a href="../../api/stateEstimation/#JuliaGrid.pmuPlacement!">pmuPlacement!</a> function, as demonstrated in the <a href="../../manual/pmuStateEstimation/#PhasorMeasurementsManual">PMU State Estimation</a> manual.</p><hr/><h5 id="Phasor-Measurements"><a class="docs-heading-anchor" href="#Phasor-Measurements">Phasor Measurements</a><a id="Phasor-Measurements-1"></a><a class="docs-heading-anchor-permalink" href="#Phasor-Measurements" title="Permalink"></a></h5><p>Finally, the complete set of phasor measurements is observed, as illustrated in Figure 2:</p><pre><code class="language-julia hljs">printPmuData(system, device; width = Dict(&quot;Label&quot; =&gt; 15))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|-----------------------------------------------------------------------------------|
| PMU Data                                                                          |
|-----------------------------------------------------------------------------------|
|     Label     |        Voltage Magnitude        |          Voltage Angle          |
|               |                                 |                                 |
|               | Measurement | Variance | Status | Measurement | Variance | Status |
|               |        [pu] |     [pu] |        |       [rad] |    [rad] |        |
|---------------|-------------|----------|--------|-------------|----------|--------|
| Bus 2         |      0.9817 | 1.00e-08 |      1 |     -0.0269 | 1.00e-08 |      1 |
| Bus 5         |      0.9782 | 1.00e-08 |      1 |     -0.0407 | 1.00e-08 |      1 |
|-----------------------------------------------------------------------------------|
|-----------------------------------------------------------------------------------|
| PMU Data                                                                          |
|-----------------------------------------------------------------------------------|
|     Label     |        Current Magnitude        |          Current Angle          |
|               |                                 |                                 |
|               | Measurement | Variance | Status | Measurement | Variance | Status |
|               |        [pu] |     [pu] |        |       [rad] |    [rad] |        |
|---------------|-------------|----------|--------|-------------|----------|--------|
| From Branch 2 |      0.2282 | 1.00e-08 |      1 |      0.1829 | 1.00e-08 |      1 |
| From Branch 7 |      0.1058 | 1.00e-08 |      1 |     -0.3102 | 1.00e-08 |      1 |
| From Branch 5 |      0.0508 | 1.00e-08 |      1 |     -1.5712 | 1.00e-08 |      1 |
| From Branch 8 |      0.0414 | 1.00e-08 |      1 |      2.8992 | 1.00e-08 |      1 |
| To Branch 1   |      0.5984 | 1.00e-08 |      1 |      2.9124 | 1.00e-08 |      1 |
| To Branch 8   |      0.0414 | 1.00e-08 |      1 |     -0.2424 | 1.00e-08 |      1 |
| To Branch 4   |      0.1413 | 1.00e-08 |      1 |      2.0979 | 1.00e-08 |      1 |
|-----------------------------------------------------------------------------------|</code></pre><hr/><h2 id="Base-Case-Analysis"><a class="docs-heading-anchor" href="#Base-Case-Analysis">Base Case Analysis</a><a id="Base-Case-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Base-Case-Analysis" title="Permalink"></a></h2><p>Once the measurements are obtained, the state estimation model is created:</p><pre><code class="language-julia hljs">analysis = pmuStateEstimation(system, device)</code></pre><p>Next, the model is solved to obtain the WLS estimator for bus voltages, and the results are used to compute powers:</p><pre><code class="language-julia hljs">stateEstimation!(system, analysis; power = true, verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The solution of the PMU state estimation was found.</code></pre><p>This enables users to observe the estimated bus voltages along with the corresponding power values:</p><pre><code class="language-julia hljs">printBusData(system, analysis; show)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Bus Data                                                                                 |
|------------------------------------------------------------------------------------------|
| Label |       Voltage       | Power Generation  |   Power Demand    |  Power Injection   |
|       |                     |                   |                   |                    |
|   Bus | Magnitude |   Angle | Active | Reactive | Active | Reactive |  Active | Reactive |
|       |      [pu] |   [rad] |   [pu] |     [pu] |   [pu] |     [pu] |    [pu] |     [pu] |
|-------|-----------|---------|--------|----------|--------|----------|---------|----------|
| Bus 1 |    0.9999 |  0.0000 | 0.7772 |   0.2349 | 0.0000 |   0.0000 |  0.7772 |   0.2349 |
| Bus 2 |    0.9818 | -0.0269 | 0.0000 |   0.0000 | 0.2170 |   0.1270 | -0.2170 |  -0.1270 |
| Bus 3 |    0.9897 | -0.0797 | 0.0000 |  -0.0000 | 0.4780 |  -0.0390 | -0.4780 |   0.0390 |
| Bus 4 |    0.9999 | -0.0302 | 0.4120 |   0.1687 | 0.0760 |   0.0160 |  0.3360 |   0.1527 |
| Bus 5 |    0.9781 | -0.0408 | 0.0000 |   0.0000 | 0.1120 |   0.0750 | -0.1120 |  -0.0750 |
| Bus 6 |    0.9760 | -0.0398 | 0.0000 |   0.0000 | 0.2950 |   0.1660 | -0.2950 |  -0.1660 |
|------------------------------------------------------------------------------------------|</code></pre><p>Users can also compare these results with those obtained from AC power flow:</p><pre><code class="language-julia hljs">power!(system, powerFlow)
printBusData(system, powerFlow; show)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Bus Data                                                                                 |
|------------------------------------------------------------------------------------------|
| Label |       Voltage       | Power Generation  |   Power Demand    |  Power Injection   |
|       |                     |                   |                   |                    |
|   Bus | Magnitude |   Angle | Active | Reactive | Active | Reactive |  Active | Reactive |
|       |      [pu] |   [rad] |   [pu] |     [pu] |   [pu] |     [pu] |    [pu] |     [pu] |
|-------|-----------|---------|--------|----------|--------|----------|---------|----------|
| Bus 1 |    1.0000 |  0.0000 | 0.7773 |   0.2349 | 0.0000 |   0.0000 |  0.7773 |   0.2349 |
| Bus 2 |    0.9819 | -0.0269 | 0.0000 |   0.0000 | 0.2170 |   0.1270 | -0.2170 |  -0.1270 |
| Bus 3 |    0.9898 | -0.0798 | 0.0000 |   0.0000 | 0.4780 |  -0.0390 | -0.4780 |   0.0390 |
| Bus 4 |    1.0000 | -0.0302 | 0.4120 |   0.1687 | 0.0760 |   0.0160 |  0.3360 |   0.1527 |
| Bus 5 |    0.9782 | -0.0408 | 0.0000 |   0.0000 | 0.1120 |   0.0750 | -0.1120 |  -0.0750 |
| Bus 6 |    0.9761 | -0.0398 | 0.0000 |   0.0000 | 0.2950 |   0.1660 | -0.2950 |  -0.1660 |
|------------------------------------------------------------------------------------------|</code></pre><p>Additionally, estimated power flows at branches can be examined:</p><pre><code class="language-julia hljs">printBranchData(system, analysis; show)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------|
| Branch Data                                                            |
|------------------------------------------------------------------------|
|            Label             |   From-Bus Power   |    To-Bus Power    |
|                              |                    |                    |
|   Branch | From-Bus | To-Bus |  Active | Reactive |  Active | Reactive |
|          |          |        |    [pu] |     [pu] |    [pu] |     [pu] |
|----------|----------|--------|---------|----------|---------|----------|
| Branch 1 | Bus 1    | Bus 2  |  0.5827 |   0.1360 | -0.5755 |  -0.1181 |
| Branch 2 | Bus 2    | Bus 3  |  0.2191 |  -0.0467 | -0.2181 |   0.0586 |
| Branch 3 | Bus 3    | Bus 4  | -0.2599 |  -0.0196 |  0.2613 |   0.0328 |
| Branch 4 | Bus 4    | Bus 5  |  0.0747 |   0.1199 | -0.0743 |  -0.1165 |
| Branch 5 | Bus 5    | Bus 6  |  0.0020 |   0.0496 | -0.0020 |  -0.0495 |
| Branch 6 | Bus 1    | Bus 6  |  0.1945 |   0.0989 | -0.1935 |  -0.0889 |
| Branch 7 | Bus 2    | Bus 6  |  0.0997 |   0.0290 | -0.0995 |  -0.0276 |
| Branch 8 | Bus 5    | Bus 2  | -0.0397 |  -0.0081 |  0.0397 |   0.0087 |
|------------------------------------------------------------------------|</code></pre><hr/><h2 id="Modifying-Measurement-Data"><a class="docs-heading-anchor" href="#Modifying-Measurement-Data">Modifying Measurement Data</a><a id="Modifying-Measurement-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Modifying-Measurement-Data" title="Permalink"></a></h2><p>Measurement values and variances are now updated. Instead of recreating the measurement set and the PMU state estimation model from the beginning, both are modified simultaneously:</p><pre><code class="language-julia hljs">updatePmu!(system, device, analysis; label = &quot;From Branch 8&quot;, magnitude = 1.1)
updatePmu!(system, device, analysis; label = &quot;From Branch 2&quot;, angle = 0.2, noise = true)</code></pre><p>These updates demonstrate the flexibility of JuliaGrid in modifying measurements. For the phasor measurement at <code>From Branch 8</code>, only the voltage magnitude is changed, while the angle measurement remains the same. For <code>From Branch 2</code>, only the angle value is updated by adding white Gaussian noise, while the magnitude remains unchanged.</p><p>Next, the PMU state estimation is solved again to compute the new estimate:</p><pre><code class="language-julia hljs">stateEstimation!(system, analysis; power = true, verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The solution of the PMU state estimation was found.</code></pre><p>Bus-related data can now be examined:</p><pre><code class="language-julia hljs">printBusData(system, analysis; show)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|-------------------------------------------------------------------------------------------|
| Bus Data                                                                                  |
|-------------------------------------------------------------------------------------------|
| Label |       Voltage       |  Power Generation  |   Power Demand    |  Power Injection   |
|       |                     |                    |                   |                    |
|   Bus | Magnitude |   Angle |  Active | Reactive | Active | Reactive |  Active | Reactive |
|       |      [pu] |   [rad] |    [pu] |     [pu] |   [pu] |     [pu] |    [pu] |     [pu] |
|-------|-----------|---------|---------|----------|--------|----------|---------|----------|
| Bus 1 |    1.0023 |  0.0184 |  0.9476 |   0.2633 | 0.0000 |   0.0000 |  0.9476 |   0.2633 |
| Bus 2 |    0.9837 | -0.0081 |  0.3810 |  -0.0038 | 0.2170 |   0.1270 |  0.1640 |  -0.1308 |
| Bus 3 |    0.9915 | -0.0609 |  0.1924 |  -0.0092 | 0.4780 |  -0.0390 | -0.2856 |   0.0298 |
| Bus 4 |    0.9984 | -0.0486 |  0.2199 |   0.1639 | 0.0760 |   0.0160 |  0.1439 |   0.1479 |
| Bus 5 |    0.9768 | -0.0596 | -0.1058 |   0.0308 | 0.1120 |   0.0750 | -0.2178 |  -0.0442 |
| Bus 6 |    0.9735 | -0.0581 | -0.4421 |  -0.0083 | 0.2950 |   0.1660 | -0.7371 |  -0.1743 |
|-------------------------------------------------------------------------------------------|</code></pre><p>With the updated measurement values, the estimated results deviate more significantly from the exact values obtained through AC power flow, as the modified measurements no longer align with them.</p><hr/><h2 id="Modifying-Measurement-Set"><a class="docs-heading-anchor" href="#Modifying-Measurement-Set">Modifying Measurement Set</a><a id="Modifying-Measurement-Set-1"></a><a class="docs-heading-anchor-permalink" href="#Modifying-Measurement-Set" title="Permalink"></a></h2><p>Excluding phasor measurements from the set, when obtained using optimal placement, should be done with caution, as it can easily render the system unobservable. In this example, two measurements will be taken out-of-service, and two additional measurements will be immediately included to maintain observability:</p><pre><code class="language-julia hljs">updatePmu!(system, device; label = &quot;From Branch 2&quot;, status = 0)
updatePmu!(system, device; label = &quot;From Branch 8&quot;, status = 0)

addPmu!(system, device; to = &quot;Branch 2&quot;, magnitude = 0.2282, angle = -2.9587)
addPmu!(system, device; to = &quot;Branch 8&quot;, magnitude = 0.0414, angle = -0.2424)</code></pre><p>Since new measurements are being added, <code>analysis</code> is not passed to these functions. Directly modifying the existing PMU state estimation model is not possible in this case. To achieve this, users should define the new measurements beforehand with <code>status = 0</code> and then activate them by setting <code>status = 1</code>.</p><p>Next, the PMU state estimation model is created and solved:</p><pre><code class="language-julia hljs">analysis = pmuStateEstimation(system, device)
stateEstimation!(system, analysis; power = true, verbose = 1)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EXIT: The solution of the PMU state estimation was found.</code></pre><p>Bus-related data can now be examined:</p><pre><code class="language-julia hljs">printBusData(system, analysis; show)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">|------------------------------------------------------------------------------------------|
| Bus Data                                                                                 |
|------------------------------------------------------------------------------------------|
| Label |       Voltage       | Power Generation  |   Power Demand    |  Power Injection   |
|       |                     |                   |                   |                    |
|   Bus | Magnitude |   Angle | Active | Reactive | Active | Reactive |  Active | Reactive |
|       |      [pu] |   [rad] |   [pu] |     [pu] |   [pu] |     [pu] |    [pu] |     [pu] |
|-------|-----------|---------|--------|----------|--------|----------|---------|----------|
| Bus 1 |    0.9999 |  0.0000 | 0.7772 |   0.2349 | 0.0000 |   0.0000 |  0.7772 |   0.2349 |
| Bus 2 |    0.9818 | -0.0269 | 0.0000 |   0.0000 | 0.2170 |   0.1270 | -0.2170 |  -0.1270 |
| Bus 3 |    0.9897 | -0.0797 | 0.0000 |  -0.0000 | 0.4780 |  -0.0390 | -0.4780 |   0.0390 |
| Bus 4 |    0.9999 | -0.0302 | 0.4120 |   0.1687 | 0.0760 |   0.0160 |  0.3360 |   0.1527 |
| Bus 5 |    0.9781 | -0.0408 | 0.0000 |   0.0000 | 0.1120 |   0.0750 | -0.1120 |  -0.0750 |
| Bus 6 |    0.9760 | -0.0398 | 0.0000 |   0.0000 | 0.2950 |   0.1660 | -0.2950 |  -0.1660 |
|------------------------------------------------------------------------------------------|</code></pre><p>By taking certain measurements out-of-service, the estimation was affected. Adding more precise measurements while maintaining observability led to an estimation that more accurately reflects the exact power system state.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../acStateEstimation/">« AC State Estimation</a><a class="docs-footer-nextpage" href="../dcStateEstimation/">DC State Estimation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.9.0 on <span class="colophon-date" title="Wednesday 19 March 2025 14:15">Wednesday 19 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
