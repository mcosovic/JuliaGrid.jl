<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bad Data Analysis · JuliaGrid</title><meta name="title" content="Bad Data Analysis · JuliaGrid"/><meta property="og:title" content="Bad Data Analysis · JuliaGrid"/><meta property="twitter:title" content="Bad Data Analysis · JuliaGrid"/><meta name="description" content="Documentation for JuliaGrid."/><meta property="og:description" content="Documentation for JuliaGrid."/><meta property="twitter:description" content="Documentation for JuliaGrid."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/tablestyle.css" rel="stylesheet" type="text/css"/><link href="../../assets/citations.css" rel="stylesheet" type="text/css"/><link href="../../assets/subfigure.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="JuliaGrid logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">JuliaGrid</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../../manual/acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../../manual/dcPowerFlow/">DC Power Flow</a></li><li><a class="tocitem" href="../../manual/acOptimalPowerFlow/">AC Optimal Power Flow</a></li><li><a class="tocitem" href="../../manual/dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../../manual/measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../../manual/observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../../manual/acStateEstimation/">AC State Estimation</a></li><li><a class="tocitem" href="../../manual/pmuStateEstimation/">PMU State Estimation</a></li><li><a class="tocitem" href="../../manual/dcStateEstimation/">DC State Estimation</a></li><li><a class="tocitem" href="../../manual/badDataAnalysis/">Bad Data Analysis</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../dcPowerFlow/">DC Power Flow</a></li><li><a class="tocitem" href="../acOptimalPowerFlow/">AC Optimal Power Flow</a></li><li><a class="tocitem" href="../dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../acStateEstimation/">AC State Estimation</a></li><li><a class="tocitem" href="../pmuStateEstimation/">PMU State Estimation</a></li><li><a class="tocitem" href="../dcStateEstimation/">DC State Estimation</a></li><li><a class="tocitem" href="../perunit/">Per-Unit System</a></li><li class="is-active"><a class="tocitem" href>Bad Data Analysis</a><ul class="internal"><li><a class="tocitem" href="#ResidualTestTutorials"><span>Largest Normalized Residual Test</span></a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/powerSystemDatasets/">Power System Datasets</a></li><li><a class="tocitem" href="../../examples/acPowerFlow/">AC Power Flow</a></li><li><a class="tocitem" href="../../examples/dcPowerFlow/">DC Power Flow</a></li><li><a class="tocitem" href="../../examples/acOptimalPowerFlow/">AC Optimal Power Flow</a></li><li><a class="tocitem" href="../../examples/dcOptimalPowerFlow/">DC Optimal Power Flow</a></li><li><a class="tocitem" href="../../examples/observabilityAnalysis/">Observability Analysis</a></li><li><a class="tocitem" href="../../examples/acStateEstimation/">AC State Estimation</a></li><li><a class="tocitem" href="../../examples/pmuStateEstimation/">PMU State Estimation</a></li><li><a class="tocitem" href="../../examples/dcStateEstimation/">DC State Estimation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">API Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/powerSystemModel/">Power System Model</a></li><li><a class="tocitem" href="../../api/powerFlow/">Power Flow</a></li><li><a class="tocitem" href="../../api/optimalPowerFlow/">Optimal Power Flow</a></li><li><a class="tocitem" href="../../api/measurementModel/">Measurement Model</a></li><li><a class="tocitem" href="../../api/stateEstimation/">State Estimation</a></li><li><a class="tocitem" href="../../api/analysis/">Powers and Currents</a></li><li><a class="tocitem" href="../../api/setupPrint/">Setup and Print</a></li><li><a class="tocitem" href="../../api/publicTypes/">Public Types</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Background</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../background/installation/">Installation Guide</a></li><li><a class="tocitem" href="../../background/bibliography/">Bibliography</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Bad Data Analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Bad Data Analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mcosovic/JuliaGrid.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mcosovic/JuliaGrid.jl/blob/master/docs/src/tutorials/badDataAnalysis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="BadDataTutorials"><a class="docs-heading-anchor" href="#BadDataTutorials">Bad Data Analysis</a><a id="BadDataTutorials-1"></a><a class="docs-heading-anchor-permalink" href="#BadDataTutorials" title="Permalink"></a></h1><p>One of the essential state estimation routines is the bad data analysis, which follows after obtaining the weighted least-squares (WLS) estimator. Its main task is to detect and identify measurement errors, and eliminate them if possible. This is usually done by processing the measurement residuals [<a href="../../background/bibliography/#aburbook">5</a>, Ch. 5], and typically, the largest normalized residual test is used to identify bad data. The largest normalized residual test is performed after we obtained the solution of the state estimation in the repetitive process of identifying and eliminating bad data measurements one after another [<a href="../../background/bibliography/#korres2010distributed">24</a>].</p><p>To initiate the process, let us construct the <code>PowerSystem</code> type and formulate the AC model:</p><pre><code class="language-julia hljs">system = powerSystem()

addBus!(system; label = 1, type = 3, active = 0.5)
addBus!(system; label = 2, type = 1, reactive = 0.3)
addBus!(system; label = 3, type = 1, active = 0.5)

@branch(resistance = 0.02, susceptance = 0.04)
addBranch!(system; label = 1, from = 1, to = 2, reactance = 0.6)
addBranch!(system; label = 2, from = 1, to = 3, reactance = 0.7)
addBranch!(system; label = 3, from = 2, to = 3, reactance = 0.2)

addGenerator!(system; label = 1, bus = 1, active = 3.2, reactive = 0.2)

acModel!(system)</code></pre><hr/><p>Following that, we introduce the <code>Measurement</code> type, which represents a set of measurement devices <span>$\mathcal M$</span>:</p><pre><code class="language-julia hljs">device = measurement()

addWattmeter!(system, device; label = &quot;Watmeter 1&quot;, bus = 3, active = -0.5)
addWattmeter!(system, device; label = &quot;Watmeter 2&quot;, from = 1, active = 0.2)
addWattmeter!(system, device; label = &quot;Watmeter 3&quot;, bus = 3, active = 3.1)

addVarmeter!(system, device; label = &quot;Varmeter 1&quot;, bus = 2, reactive = -0.3)
addVarmeter!(system, device; label = &quot;Varmeter 3&quot;, from = 1, reactive = 0.2)

addPmu!(system, device; label = &quot;PMU 1&quot;, bus = 1, magnitude = 1.0, angle = 0.0)
addPmu!(system, device; label = &quot;PMU 2&quot;, bus = 3, magnitude = 0.9, angle = -0.2)</code></pre><hr/><h2 id="ResidualTestTutorials"><a class="docs-heading-anchor" href="#ResidualTestTutorials">Largest Normalized Residual Test</a><a id="ResidualTestTutorials-1"></a><a class="docs-heading-anchor-permalink" href="#ResidualTestTutorials" title="Permalink"></a></h2><p>Let the WLS estimator <span>$\hat {\mathbf x}$</span> be obtained by solving the AC state estimation:</p><pre><code class="language-julia hljs">analysis = gaussNewton(system, device)
stateEstimation!(system, analysis)</code></pre><p>Next, we run the bad data analysis:</p><pre><code class="language-julia hljs">outlier = residualTest!(system, device, analysis; threshold = 4.0)</code></pre><p>In this step, we employ the largest normalized residual test, guided by the analysis outlined in [<a href="../../background/bibliography/#aburbook">5</a>, Sec. 5.7]. To be more precise, we compute all measurement residuals based on the obtained estimate of state variables:</p><p class="math-container">\[    r_i = z_i - h_i(\hat {\mathbf x}), \;\;\; i \in \mathcal M.\]</p><p>The normalized residuals for all measurements are computed as follows:</p><p class="math-container">\[    \bar{r}_i  = \cfrac{|r_i|}{\sqrt{S_{ii}\Sigma_{ii}}} = \cfrac{|r_i|}{\sqrt{C_{ii}}}, \;\;\; i \in \mathcal M.\]</p><p>In this equation, we denote the diagonal entries of the residual covariance matrix <span>$\mathbf C \in \mathbb{R}^{k \times k}$</span> as <span>$C_{ii} = S_{ii}\Sigma_{ii}$</span>, where <span>$S_{ii}$</span> is the diagonal entry of the residual sensitivity matrix <span>$\mathbf S$</span> representing the sensitivity of the measurement residuals to the measurement errors.</p><p>The subsequent step involves selecting the largest normalized residual, and the <span>$j$</span>-th measurement is then suspected as bad data and potentially removed from the measurement set <span>$\mathcal{M}$</span>:</p><p class="math-container">\[    \bar{r}_{j} = \text{max} \{\bar{r}_{i}, \forall i \in \mathcal{M} \}.\]</p><p>Users can access this information using the variable:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; outlier.maxNormalizedResidual</code><code class="nohighlight hljs ansi" style="display:block;">260.808021371269</code></pre><p>If the largest normalized residual, denoted as <span>$\bar{r}_{j}$</span>, satisfies the inequality:</p><p class="math-container">\[    \bar{r}_{j} \ge \epsilon,\]</p><p>the corresponding measurement is identified as bad data and subsequently removed. In this example, the bad data identification <code>threshold</code> is set to <span>$\epsilon = 4$</span>. Users can verify the satisfaction of this inequality by inspecting:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; outlier.detect</code><code class="nohighlight hljs ansi" style="display:block;">true</code></pre><p>This indicates that the measurement labeled as:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; outlier.label</code><code class="nohighlight hljs ansi" style="display:block;">&quot;Watmeter 3&quot;</code></pre><p>is removed from the measurement set and marked as out-of-service.</p><p>Subsequently, we can solve the system again, but this time without the removed measurement:</p><pre><code class="language-julia hljs">analysis = gaussNewton(system, device)
stateEstimation!(system, analysis)</code></pre><p>Following that, we check for outliers once more:</p><pre><code class="language-julia hljs">outlier = residualTest!(system, device, analysis; threshold = 4.0)</code></pre><p>To examine the value:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; outlier.maxNormalizedResidual</code><code class="nohighlight hljs ansi" style="display:block;">1.099010381719352</code></pre><p>As this value is now less than the <code>threshold</code> <span>$\epsilon = 4$</span>, the measurement is not removed, or there are no outliers. This can also be verified by observing the bad data flag:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; outlier.detect</code><code class="nohighlight hljs ansi" style="display:block;">false</code></pre><hr/><h5 id="Residual-Covariance-Matrix"><a class="docs-heading-anchor" href="#Residual-Covariance-Matrix">Residual Covariance Matrix</a><a id="Residual-Covariance-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Residual-Covariance-Matrix" title="Permalink"></a></h5><p>In AC state estimation, the residual covariance matrix <span>$\mathbf C$</span> is given by:</p><p class="math-container">\[    \mathbf C = \mathbf S \bm \Sigma = \bm \Sigma - \mathbf J (\hat {\mathbf x}) [\mathbf J (\hat {\mathbf x})^T \bm \Sigma^{-1} \mathbf J (\hat {\mathbf x})]^{-1} \mathbf J (\hat {\mathbf x})^T,\]</p><p>while for DC state estimation and state estimation using only PMUs, it is computed as:</p><p class="math-container">\[    \mathbf C = \mathbf S \bm \Sigma = \bm \Sigma - \mathbf H [\mathbf H^T \bm \Sigma^{-1} \mathbf H]^{-1} \mathbf H^T.\]</p><p>It is important to note that only the diagonal entries of <span>$\mathbf C$</span> are required. The main computational challenge lies in computing the inverse on the right-hand side of the equations. The JuliaGrid package employs a computationally efficient sparse inverse method, obtaining only the necessary elements.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../perunit/">« Per-Unit System</a><a class="docs-footer-nextpage" href="../../examples/powerSystemDatasets/">Power System Datasets »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Friday 14 March 2025 20:54">Friday 14 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
